<template>
  <section class="automation-section">
    <div class="page-header">
      <h1 class="page-title">è„šæœ¬è‡ªåŠ¨åŒ–</h1>
      <p class="page-description">
        é€šè¿‡å½•åˆ¶å’Œæ‰§è¡Œè„šæœ¬ï¼Œå®ç°é‡å¤æ€§å·¥ä½œçš„è‡ªåŠ¨åŒ–ï¼Œæé«˜å·¥ä½œæ•ˆç‡
      </p>
    </div>

    <div class="automation-content">
      <div class="automation-sidebar">
        <div class="sidebar-menu">
          <h3>åŠŸèƒ½å¯¼èˆª</h3>
          <ul>
            <li
              class="sidebar-item active"
              data-tab="layout"
              @click="switchTab('layout')"
            >
              å¸ƒå±€ä»‹ç»
            </li>
            <li
              class="sidebar-item"
              data-tab="recording"
              @click="switchTab('recording')"
            >
              ç™»å½• & é¦–é¡µ
            </li>
            <li
              class="sidebar-item"
              data-tab="management"
              @click="switchTab('management')"
            >
              å½•åˆ¶è„šæœ¬
            </li>
            <li
              class="sidebar-item"
              data-tab="variables"
              @click="switchTab('variables')"
            >
              æ‰‹åŠ¨æ·»åŠ è„šæœ¬
            </li>
            <li
              class="sidebar-item"
              data-tab="plugins"
              @click="switchTab('plugins')"
            >
              ç¼–è¾‘è„šæœ¬
            </li>
          </ul>
        </div>
      </div>

      <div class="main-content">
        <!-- <FontDecration>æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š</FontDecration> -->

        <!-- å¸ƒå±€ä»‹ç» -->
        <div class="recordSteps autoLayout">
          <h3>âœ… å¸ƒå±€ä»‹ç»</h3>
          1. æ‰“å¼€åº”ç”¨åï¼Œä½¿ç”¨ä¼ä¸šå¾®ä¿¡æ‰«ç ç™»å½•ï¼Œç™»å½•æˆåŠŸåå³å¯è¿›å…¥é¦–é¡µ
          <div class="imgStyle">
            <img src="@/assets/capture2.png" alt="" />
          </div>
          <p></p>
        </div>

        <!-- é¦–é¡µæ­¥éª¤ -->
        <div class="recordSteps autoIndex">
          <h3>âœ… ç™»å½•åŠé¦–é¡µä»‹ç»</h3>
          <ul>
            <li>
              1. æ‰“å¼€åº”ç”¨åï¼Œä½¿ç”¨ä¼ä¸šå¾®ä¿¡æ‰«ç ç™»å½•ï¼Œç™»å½•æˆåŠŸåå³å¯è¿›å…¥é¦–é¡µ
              <div class="imgStyle">
                <img src="@/assets/capture2.png" alt="" />
              </div>
            </li>
            <li>
              2.
              ç™»å½•æˆåŠŸåè·³è½¬é¦–é¡µï¼Œé¦–é¡µæ˜¯é¦–æ˜¾ç¤ºæœ¬åœ°å·²æœ‰çš„è„šæœ¬ï¼Œå¯ä»¥æ ¹æ®åå­—æ¨¡ç³ŠåŒ¹é…è¿›è¡Œæœç´¢ğŸ”
              <br />
              <div class="imgStyle">
                <img src="@/assets/capture1.png" alt="" />
              </div>
            </li>
            <li>
              3. ç‚¹å‡»æ ‡é¢˜ï¼Œå¯ä»¥è·³è½¬åˆ°è„šæœ¬è¯¦æƒ…é¡µé¢
              <div class="imgStyle">
                <img src="@/assets/img.png" alt="" />
              </div>
            </li>
          </ul>
          <p></p>
        </div>

        <!-- å½•åˆ¶è„šæœ¬æ­¥éª¤ -->
        <div class="recordSteps autoRecord">
          <h3>âœ… å¦‚ä½•å½•åˆ¶è„šæœ¬</h3>
          <ul>
            <li>
              1.
              ç‚¹å‡»ä¸‹æ–¹ç¬¬äºŒä¸ªèœå•å›¾æ ‡ï¼Œè¿›å…¥æ–°å»ºé¡µé¢ï¼Œæ”¯æŒä¸¤ç§æ–¹å¼ï¼šå½•åˆ¶è„šæœ¬å’Œæ‰‹åŠ¨æ·»åŠ è„šæœ¬
            </li>
            <li>
              2.
              å¯ä»¥ç›´æ¥ç‚¹å‡»å½•åˆ¶æŒ‰é’®ï¼Œå±å¹•å³ä¸‹è§’ä¼šå‡ºç°ä¸‰ä¸ªæŒ‰é’®ï¼Œä»å·¦åˆ°å³åˆ†åˆ«æ˜¯åœæ­¢ã€å½•åˆ¶ã€è¿”å›æŒ‰é’®
              <br />
              <div class="imgStyle">
                <img src="@/assets/img.png" alt="" />
              </div>
            </li>
            <li>
              3. ç‚¹å‡»å½•åˆ¶æŒ‰é’®å°±å¯ä»¥å¼€å§‹å½•åˆ¶å±å¹•çš„æ“ä½œäº†
              <div class="tip-box">
                <span class="tip-icon">æç¤ºï¼š</span>
                <span class="tip-content">
                  å½•åˆ¶è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ“ä½œæ…¢ä¸€ç‚¹ï¼Œå½“å·¦ä¸‹è§’æ˜¾ç¤º"è¯†åˆ«ä¸­..."æ—¶ï¼Œè¯·ä¸è¦æ“ä½œï¼Œå¦åˆ™æ­¥éª¤å¯èƒ½ä¼šä¸¢å¤±</span
                >
              </div>
              <div class="imgStyle">
                <img src="@/assets/img.png" alt="" />
              </div>
            </li>
            <li>
              4.å½•åˆ¶å®Œæˆåç‚¹å‡»åœæ­¢å½•åˆ¶ï¼Œå†æ¬¡ç‚¹å‡»è¿”å›ï¼Œå¯ä»¥çœ‹è§é¡µé¢ä¸Šå‡ºç°åˆšåˆšå½•åˆ¶çš„æ­¥éª¤
              <div class="imgStyle">
                <img src="@/assets/img.png" alt="" />
              </div>
            </li>
            <li>
              5.ç‚¹å‡»æ‰§è¡Œç¨‹åºå¯ä»¥è‡ªåŠ¨æ‰§è¡Œåˆšåˆšæ‰‹åŠ¨æ“ä½œçš„æ­¥éª¤
              <div class="imgStyle">
                <img src="@/assets/img.png" alt="" />
              </div>
            </li>
          </ul>
          <p></p>
        </div>

        <!-- æ·»åŠ è„šæœ¬æ­¥éª¤ -->
        <div class="recordSteps autoAdd">
          <h3>âœ… å¦‚ä½•æ‰‹åŠ¨æ·»åŠ è„šæœ¬</h3>
          <ul>
            <li>
              1. ç‚¹å‡»ä¸‹æ–¹æ·»åŠ æ­¥éª¤æŒ‰é’®ï¼Œåœ¨å¼¹å‡ºçš„æ’ä»¶æŒ‡ä»¤ä¸­é€‰æ‹©æŒ‡ä»¤
              <div class="imgStyle">
                <img src="@/assets/img.png" alt="" />
              </div>
            </li>
            <li>
              2.
              å°†é¼ æ ‡æ‚¬æµ®åˆ°å·²æ·»åŠ çš„æ­¥éª¤ä¸Šæ—¶ï¼Œä¼šè‡ªåŠ¨æ‚¬æµ®æ˜¾ç¤ºæ·»åŠ æŒ‰é’®ï¼Œç‚¹å‡»åå³å¯åœ¨è¯¥æ­¥éª¤åæ·»åŠ æ–°æ­¥éª¤
              <br />
              <div class="imgStyle">
                <img src="@/assets/img.png" alt="" />
              </div>
            </li>
          </ul>
          <p></p>
        </div>

        <!-- ç¼–è¾‘è„šæœ¬æ­¥éª¤ -->
        <div class="recordSteps autoEdit">
          <h3>âœ… å¦‚ä½•ç¼–è¾‘å·²æœ‰è„šæœ¬</h3>
          <ul>
            <li>
              1.
              é¦–å…ˆè¿›å…¥é¦–é¡µï¼Œç‚¹å‡»æƒ³è¦ç¼–è¾‘çš„è„šæœ¬ï¼Œè¿›å…¥ç¼–è¾‘é¡µé¢ï¼Œè¿™é‡Œæ”¯æŒä¿®æ”¹è„šæœ¬åç§°ï¼Œæ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤ã€ç§»åŠ¨æ­¥éª¤
              <div class="imgStyle">
                <img src="@/assets/img.png" alt="" />
              </div>
            </li>
            <li>
              2.
              æ–°å¢ï¼šä¸æ‰‹åŠ¨æ·»åŠ æ­¥éª¤ç±»ä¼¼ï¼Œæ‚¬æµ®åˆ°å·²æœ‰æ­¥éª¤ä¸Šï¼Œç‚¹å‡»æ–°å¢åŠ¨ç”»å›¾æ ‡ï¼Œå¯ä»¥æ·»åŠ æ–°çš„æ­¥éª¤
              <br />
              <div class="imgStyle">
                <img src="@/assets/img.png" alt="" />
              </div>
            </li>
            <li>
              3. ä¿®æ”¹ï¼šæ‚¬æµ®åˆ°å·²æœ‰æ­¥éª¤ä¸Šï¼Œç‚¹å‡»ä¿®æ”¹å›¾æ ‡ï¼Œå¯ä»¥ä¿®æ”¹è¯¥æ­¥éª¤
              <br />
              <div class="imgStyle">
                <img src="@/assets/img.png" alt="" />
              </div>
            </li>
            <li>
              4. åˆ é™¤ï¼šæ‚¬æµ®åˆ°å·²æœ‰æ­¥éª¤ä¸Šï¼Œç‚¹å‡»åˆ é™¤å›¾æ ‡ï¼Œå¯ä»¥åˆ é™¤è¯¥æ­¥éª¤
              <br />
              <div class="imgStyle">
                <img src="@/assets/img.png" alt="" />
              </div>
            </li>
            <li>
              5.
              ç§»åŠ¨ï¼šæ‚¬æµ®åˆ°å·²æœ‰æ­¥éª¤åç§°ä¸Šï¼Œç‚¹å‡»å¯ä»¥æ‹–åŠ¨è¯¥æ­¥éª¤åˆ°æŒ‡å®šä½ç½®ï¼Œå…¶ä½™æ­¥éª¤é¡ºåºé¡ºç§»
              <br />
              <div class="imgStyle">
                <img src="@/assets/img.png" alt="" />
              </div>
            </li>
            <li>
              6. å½•åˆ¶ï¼šç‚¹å‡»åï¼Œå¯ä»¥åœ¨å¼¹å‡ºæ¡†ä¸­ï¼Œé€‰æ‹©è¦†ç›–æˆ–è¿½åŠ æ­¥éª¤
              <br />
              <div class="imgStyle">
                <img src="@/assets/img.png" alt="" />
              </div>
            </li>
            <li>
              7. æ‰§è¡Œï¼šä¸Šæ–¹è“è‰²æ‰§è¡ŒæŒ‰é’®è¡¨ç¤ºæ‰§è¡Œè¯¥è„šæœ¬å…¨éƒ¨å†…å®¹
              <br />
              <div class="imgStyle">
                <img src="@/assets/img.png" alt="" />
              </div>
            </li>
            <li>
              8. æµ‹è¯•ï¼šç‚¹å‡»åå•æ­¥æ‰§è¡Œå½“å‰æ­¥éª¤
              <br />
              <div class="imgStyle">
                <img src="@/assets/img.png" alt="" />
              </div>
            </li>
          </ul>
          <p></p>
        </div>
      </div>
    </div>
  </section>
</template>

<script>
// import FontDecration from '@/components/FontDecration.vue'

export default {
  name: 'AutomationSection',
  data() {
    return {
      activeTab: 'layout'
    }
  },
  mounted() {
    this.setupScrollSpy()
  },
  methods: {
    // åˆ‡æ¢æ ‡ç­¾
    switchTab(tab) {
      this.activeTab = tab

      // æ›´æ–°èœå•æ¿€æ´»çŠ¶æ€
      const menuItems = document.querySelectorAll('.sidebar-item')
      menuItems.forEach((item) => {
        item.classList.remove('active')
        if (item.getAttribute('data-tab') === tab) {
          item.classList.add('active')
        }
      })

      // æ»šåŠ¨åˆ°å¯¹åº”åŒºåŸŸ
      const sectionMap = {
        recording: 'autoIndex',
        management: 'autoRecord',
        variables: 'autoAdd',
        plugins: 'autoEdit',
        layout: 'autoLayout'
      }
      const targetSection = document.querySelector(`.${sectionMap[tab]}`)
      if (targetSection) {
        targetSection.scrollIntoView({ behavior: 'smooth' })
      }
    },
    // è®¾ç½®æ»šåŠ¨ç›‘å¬
    setupScrollSpy() {
      const sections = document.querySelectorAll('.recordSteps')
      const menuItems = document.querySelectorAll('.sidebar-item')

      // æ»šåŠ¨ç›‘å¬
      window.addEventListener('scroll', () => {
        let current = ''
        let maxVisibility = 0

        sections.forEach((section) => {
          const sectionTop = section.offsetTop
          const sectionHeight = section.clientHeight
          const sectionBottom = sectionTop + sectionHeight

          // è®¡ç®—å½“å‰åŒºåŸŸçš„å¯è§æ¯”ä¾‹
          const viewportHeight = window.innerHeight
          // const visibleTop = Math.max(0, sectionTop - pageYOffset)
          const visibleBottom =
            Math.min(sectionBottom, pageYOffset + viewportHeight) - sectionTop
          const visibility = visibleBottom / sectionHeight

          if (visibility > maxVisibility) {
            maxVisibility = visibility
            current = section.className.split(' ')[1]
          }
        })

        // æ›´æ–°èœå•é«˜äº®çŠ¶æ€
        menuItems.forEach((item) => {
          item.classList.remove('active')
          if (
            item.getAttribute('data-tab') === this.getTabFromSection(current)
          ) {
            item.classList.add('active')
          }
        })
      })

      // åˆå§‹åŠ è½½æ—¶è®¾ç½®ç¬¬ä¸€ä¸ªä¸ºæ¿€æ´»çŠ¶æ€
      if (menuItems.length > 0) {
        menuItems[0].classList.add('active')
      }
    },
    // æ ¹æ®åŒºåŸŸç±»åè·å–å¯¹åº”çš„æ ‡ç­¾
    getTabFromSection(sectionClass) {
      const sectionToTabMap = {
        autoIndex: 'recording',
        autoRecord: 'management',
        autoAdd: 'variables',
        autoEdit: 'plugins'
      }
      return sectionToTabMap[sectionClass] || 'recording'
    }
  }
}
</script>

<style scoped>
/* é¡µé¢æ ‡é¢˜ */
.page-header {
  margin-bottom: 32px;
}
.page-header h1 {
  font-size: 28px;
  margin-bottom: 8px;
  color: #1f2937;
}

.page-description {
  color: #6b7280;
  font-size: 16px;
}

/* è„šæœ¬è‡ªåŠ¨åŒ–é¡µé¢æ ·å¼ */
.automation-section {
  display: flex;
  flex-direction: column;
  flex: 1;
  overflow: hidden;
  height: 100%;
}

.automation-content {
  display: flex;
  flex: 1;
  gap: 24px;
  overflow: hidden;
  background-color: white;
  border-radius: 16px;
}

.automation-sidebar {
  width: 240px;
  flex-shrink: 0;
  position: sticky;
  top: 0;
  height: 100%;
  display: flex;
  flex-direction: column;
  gap: 24px;
  padding: 24px;
  overflow-y: hidden;
}

.sidebar-menu h3 {
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 12px;
  color: #374151;
  margin-bottom: 14px;
}

.sidebar-menu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.sidebar-item {
  padding: 10px 16px;
  margin-bottom: 4px;
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.2s;
}

.sidebar-item:hover {
  background-color: #f3f4f6;
}

.sidebar-item.active {
  background-color: #f3f4f6;
  color: #333;
  font-weight: 500;
}

.main-content {
  padding: 30px 0;
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  height: 100%;
  /* éšè—æ»šåŠ¨æ¡ä½†ä¿æŒæ»šåŠ¨åŠŸèƒ½ */
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* IE and Edge */
}
/* éšè—Webkitæµè§ˆå™¨çš„æ»šåŠ¨æ¡ */
.main-content::-webkit-scrollbar {
  display: none;
}

.recordSteps {
  padding: 16px;
  /* éšè—æ»šåŠ¨æ¡ä½†ä¿æŒæ»šåŠ¨åŠŸèƒ½ */
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.tip-box {
  background-color: #fffbeb;
  border-left: 4px solid #f59e0b;
  padding: 12px 16px;
  margin: 16px 0;
  border-radius: 4px;
  display: flex;
  align-items: center;
}

.tip-icon {
  font-weight: bold;
  color: #d97706;
  margin-right: 8px;
}

.tip-content {
  color: #92400e;
  line-height: 1.5;
}

.recordSteps li {
  padding: 8px 24px;
  list-style: none;
}

.imgStyle {
  margin: 16px 6px;
  width: 80px;
}

.imgStyle img {
  width: 260%;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}
</style>
